<!doctype html>
<html>
  <head>
    <title>Updating...</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        padding: 50px;
      }
      #progress-container {
        display: none;
      }
      progress {
        width: 100%;
        margin: 20px 0;
      }
      #restart-button {
        display: none;
        padding: 10px 20px;
        background-color: #28a745;
        color: white;
        border: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div id="checking-for-update">
      <h1>Checking for updates...</h1>
    </div>
    <div id="progress-container">
      <h1>Downloading Update...</h1>
      <p id="progress-text"></p>
      <progress id="progress-bar" value="0" max="100"></progress>
    </div>
    <button id="restart-button">Restart Now</button>
    <script>
      const { ipcRenderer } = require('electron');

      ipcRenderer.on('download-progress', (event, progressObj) => {
        document.getElementById('checking-for-update').style.display = 'none';
        document.getElementById('progress-container').style.display = 'block';

        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');

        progressBar.value = progressObj.percent;
        progressText.textContent = `Download speed: ${progressObj.bytesPerSecond} - Downloaded ${progressObj.percent}% (${progressObj.transferred}/${progressObj.total})`;
      });

      ipcRenderer.on('update-downloaded', () => {
        document.getElementById('progress-container').style.display = 'none';
        document.getElementById('restart-button').style.display = 'block';
      });

      document
        .getElementById('restart-button')
        .addEventListener('click', () => {
          ipcRenderer.send('restart-app');
        });
    </script>
  </body>
</html>
